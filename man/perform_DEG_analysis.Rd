% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Differential_expression_analysis.R
\name{perform_DEG_analysis}
\alias{perform_DEG_analysis}
\title{Perform Differential Expression Analysis using limma}
\usage{
perform_DEG_analysis(
  bulk_matrix,
  phenotype,
  logFC_threshold = 1,
  pval_threshold = 0.05,
  adjust_method = "BH",
  ...
)
}
\arguments{
\item{bulk_matrix}{Bulk expression matrix with genes in rows and samples in columns.
Should be normalized and log-transformed (e.g., logCPM).}

\item{phenotype}{Vector of phenotype labels for each sample. Must contain exactly two unique groups.}

\item{logFC_threshold}{Minimum absolute log fold change for significance (default: 1)}

\item{pval_threshold}{Maximum p-value for significance (default: 0.05)}

\item{adjust_method}{Method for p-value adjustment. Options include "BH", "bonferroni",
"holm", etc. (default: "BH" for Benjamini-Hochberg)}
}
\value{
A list containing:
\item{all_results}{Complete results from limma's topTable with statistics for all genes}
\item{significant_DEGs}{Filtered differentially expressed genes meeting significance thresholds}
\item{fit}{The fitted limma model object for further analysis}
\item{n_significant}{Total number of significant DEGs}
\item{n_upregulated}{Number of significantly upregulated genes}
\item{n_downregulated}{Number of significantly downregulated genes}
\item{comparison}{Description of the comparison performed}
}
\description{
Conducts differential expression analysis on bulk RNA-seq data using the limma package.
This function identifies genes that are differentially expressed between two phenotypic groups.
}
\details{
This function performs the following steps:
\enumerate{
\item Creates a design matrix based on the phenotype groups
\item Fits a linear model using limma's empirical Bayes methods
\item Computes contrasts between the two groups
\item Extracts results and filters based on significance thresholds
}

The method is particularly suited for bulk RNA-seq data and provides robust
variance estimation through empirical Bayes moderation.
}
\examples{
\dontrun{
# Example with simulated data
set.seed(123)
bulk_matrix <- matrix(rnorm(1000*20), nrow=1000, ncol=20)
rownames(bulk_matrix) <- paste0("Gene", 1:1000)
colnames(bulk_matrix) <- paste0("Sample", 1:20)
phenotype <- rep(c("Control", "Treatment"), each=10)

# Perform DEG analysis
deg_results <- perform_DEG_analysis(
bulk_matrix = bulk_matrix,
phenotype = phenotype,
logFC_threshold = 1,
pval_threshold = 0.05
)

# View significant DEGs
head(deg_results$significant_DEGs)

# Summary statistics
cat("Total significant DEGs:", deg_results$n_significant, "\n")
cat("Upregulated:", deg_results$n_upregulated, "\n")
cat("Downregulated:", deg_results$n_downregulated, "\n")
}

}
\seealso{
\code{\link[limma:lmFit]{limma::lmFit()}}, \code{\link[limma:ebayes]{limma::eBayes()}}, \code{\link[limma:toptable]{limma::topTable()}}
}
